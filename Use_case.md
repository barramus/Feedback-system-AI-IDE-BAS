# Use Case: Отправка отзыва пользователем

## UC-001: Отправка оценки ответа

| **Элемент** | **Описание** |
|-------------|--------------|
| **Название** | UC-001. Отправка оценки ответа пользователем |
| **User Story** | US-001: Как пользователь системы, я хочу оценить качество полученного ответа с помощью звезд и оставить комментарий, чтобы предоставить обратную связь разработчикам и улучшить качество сервиса |
| **Участники** | • Основной: Пользователь системы<br>• Вторичные: Веб-интерфейс, Backend API, База данных, Система авторизации |
| **Предусловия** | • Пользователь авторизован в системе<br>• Получен ответ от системы<br>• Блок оценки отображается в интерфейсе<br>• Backend API доступен |
| **Ограничения** | • Рейтинг: от 1 до 5 звезд<br>• Комментарий: максимум 1000 символов<br>• Rate limit: максимум 5 отзывов за 10 минут<br>• Защита от дублирования по session_id |
| **Триггер** | Пользователь нажимает на звезду в блоке оценки |
| **Основной сценарий** | 1. Пользователь просматривает полученный ответ<br>2. Система отображает блок "оценить ответ [5 звезд]" после основного контента<br>3. Пользователь наводит курсор на звезды<br>4. Система подсвечивает все звезды до текущей при наведении<br>5. Пользователь кликает на звезду (например, 3-ю)<br>6. Система фиксирует рейтинг (первые 3 звезды активны)<br>7. Система автоматически показывает блок с полем для комментария<br>8. Пользователь вводит комментарий (опционально)<br>9. Пользователь нажимает кнопку «Отправить»<br>10. Система отправляет данные на бэкенд<br>11. Бэкенд валидирует данные и сохраняет отзыв<br>12. Система скрывает блок оценки<br>13. Система показывает сообщение «Спасибо за отзыв!» |
| **Альтернативные сценарии** | **п.5**: Если пользователь не авторизован → перенаправить на страницу входа<br>**п.8**: Если пользователь не вводит комментарий → отправить только рейтинг<br>**п.10**: Ошибка сети → показать сообщение "Ошибка отправки, попробуйте позже"<br>**п.11**: Rate limit превышен → показать сообщение "Слишком много запросов"<br>**п.11**: Дублирование session_id → показать сообщение "Отзыв уже отправлен"<br>**п.11**: Валидация не пройдена → показать соответствующие ошибки |
| **Постусловия** | • Отзыв сохранен в базе данных<br>• Пользователь получил подтверждение отправки<br>• Система записала метрики использования<br>• Администраторы могут просматривать статистику |

## UC-002: Просмотр статистики отзывов администратором

| **Элемент** | **Описание** |
|-------------|--------------|
| **Название** | UC-002. Просмотр статистики отзывов администратором |
| **User Story** | US-002: Как администратор системы, я хочу просматривать статистику и аналитику по всем полученным отзывам, чтобы анализировать качество сервиса и принимать решения по улучшению |
| **Участники** | • Основной: Администратор системы<br>• Вторичные: Admin API, База данных, Система авторизации |
| **Предусловия** | • Администратор авторизован<br>• Имеет права доступа к админке<br>• Admin API доступен |
| **Ограничения** | • Требуется ADMIN_API_KEY<br>• Максимум 100 записей за один запрос<br>• Доступ только к статистике отзывов |
| **Триггер** | Администратор открывает панель статистики отзывов |
| **Основной сценарий** | 1. Администратор авторизуется в админке<br>2. Система проверяет ADMIN_API_KEY<br>3. Администратор переходит в раздел "Отзывы"<br>4. Система загружает статистику<br>5. Система отображает: общее количество отзывов, средний рейтинг, распределение по звездам<br>6. Администратор применяет фильтры (по рейтингу, email, дате)<br>7. Система обновляет данные согласно фильтрам<br>8. Администратор анализирует статистику |
| **Альтернативные сценарии** | **п.2**: Неверный ADMIN_API_KEY → ошибка 403<br>**п.4**: Ошибка загрузки данных → показать сообщение об ошибке<br>**п.6**: Нет данных по фильтрам → показать "Нет данных"<br>**п.7**: Большой объем данных → показать пагинацию |
| **Постусловия** | • Статистика загружена и отображена<br>• Администратор получил аналитику для принятия решений<br>• Система записала лог доступа к админке |

## UC-003: Защита от спама и дублирования

| **Элемент** | **Описание** |
|-------------|--------------|
| **Название** | UC-003. Защита от спама и дублирования отзывов |
| **User Story** | US-003: Как система, я хочу ограничивать количество отзывов от одного пользователя и предотвращать дублирование, чтобы обеспечить качество данных и защититься от спама |
| **Участники** | • Основной: Система<br>• Вторичные: Backend API, База данных |
| **Предусловия** | • Пользователь пытается отправить отзыв<br>• Система получила запрос на создание отзыва |
| **Ограничения** | • Rate limit: 5 отзывов за 10 минут<br>• Защита от дублирования по session_id<br>• Валидация данных на бэкенде |
| **Триггер** | Поступление запроса на создание отзыва |
| **Основной сценарий** | 1. Система получает запрос на создание отзыва<br>2. Система проверяет rate limit для пользователя<br>3. Система проверяет дублирование по session_id<br>4. Система валидирует данные отзыва<br>5. Система сохраняет отзыв в БД<br>6. Система возвращает успешный ответ |
| **Альтернативные сценарии** | **п.2**: Rate limit превышен → вернуть ошибку 429<br>**п.3**: Дублирование session_id → вернуть ошибку 409<br>**п.4**: Невалидные данные → вернуть ошибку 400<br>**п.5**: Ошибка БД → вернуть ошибку 500 |
| **Постусловия** | • Отзыв сохранен или отклонен с причиной<br>• Система записала лог проверки безопасности<br>• Пользователь получил соответствующий ответ |
